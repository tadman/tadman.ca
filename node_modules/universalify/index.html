<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>universalify</title>
    <link rel="stylesheet" media="all" href="/assets/css/main.css"/>
  </head>
  <body class="bg-blue-900 p-8">
    <h1 id="universalify">universalify</h1>

<p><a href="https://travis-ci.org/RyanZim/universalify"><img src="https://img.shields.io/travis/RyanZim/universalify/master.svg" alt="Travis branch" /></a>
<img src="https://img.shields.io/coveralls/github/RyanZim/universalify/master.svg" alt="Coveralls github branch" />
<img src="https://img.shields.io/npm/dm/universalify.svg" alt="npm" />
<img src="https://img.shields.io/npm/l/universalify.svg" alt="npm" /></p>

<p>Make a callback- or promise-based function support both promises and callbacks.</p>

<p>Uses the native promise implementation.</p>

<h2 id="installation">Installation</h2>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>npm <span class="nb">install </span>universalify
</code></pre></div></div>

<h2 id="api">API</h2>

<h3 id="universalifyfromcallbackfn"><code class="language-plaintext highlighter-rouge">universalify.fromCallback(fn)</code></h3>

<p>Takes a callback-based function to universalify, and returns the universalified  function.</p>

<p>Function must take a callback as the last parameter that will be called with the signature <code class="language-plaintext highlighter-rouge">(error, result)</code>. <code class="language-plaintext highlighter-rouge">universalify</code> does not support calling the callback with three or more arguments, and does not ensure that the callback is only called once.</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">callbackFn</span> <span class="p">(</span><span class="nx">n</span><span class="p">,</span> <span class="nx">cb</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">setTimeout</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="nx">cb</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span> <span class="nx">n</span><span class="p">),</span> <span class="mi">15</span><span class="p">)</span>
<span class="p">}</span>

<span class="kd">const</span> <span class="nx">fn</span> <span class="o">=</span> <span class="nx">universalify</span><span class="p">.</span><span class="nx">fromCallback</span><span class="p">(</span><span class="nx">callbackFn</span><span class="p">)</span>

<span class="c1">// Works with Promises:</span>
<span class="nx">fn</span><span class="p">(</span><span class="dl">'</span><span class="s1">Hello World!</span><span class="dl">'</span><span class="p">)</span>
<span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">result</span> <span class="o">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">result</span><span class="p">))</span> <span class="c1">// -&gt; Hello World!</span>
<span class="p">.</span><span class="k">catch</span><span class="p">(</span><span class="nx">error</span> <span class="o">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="nx">error</span><span class="p">))</span>

<span class="c1">// Works with Callbacks:</span>
<span class="nx">fn</span><span class="p">(</span><span class="dl">'</span><span class="s1">Hi!</span><span class="dl">'</span><span class="p">,</span> <span class="p">(</span><span class="nx">error</span><span class="p">,</span> <span class="nx">result</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="k">return</span> <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="nx">error</span><span class="p">)</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span>
  <span class="c1">// -&gt; Hi!</span>
<span class="p">})</span>
</code></pre></div></div>

<h3 id="universalifyfrompromisefn"><code class="language-plaintext highlighter-rouge">universalify.fromPromise(fn)</code></h3>

<p>Takes a promise-based function to universalify, and returns the universalified  function.</p>

<p>Function must return a valid JS promise. <code class="language-plaintext highlighter-rouge">universalify</code> does not ensure that a valid promise is returned.</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">promiseFn</span> <span class="p">(</span><span class="nx">n</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="k">new</span> <span class="nb">Promise</span><span class="p">(</span><span class="nx">resolve</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">setTimeout</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="nx">resolve</span><span class="p">(</span><span class="nx">n</span><span class="p">),</span> <span class="mi">15</span><span class="p">)</span>
  <span class="p">})</span>
<span class="p">}</span>

<span class="kd">const</span> <span class="nx">fn</span> <span class="o">=</span> <span class="nx">universalify</span><span class="p">.</span><span class="nx">fromPromise</span><span class="p">(</span><span class="nx">promiseFn</span><span class="p">)</span>

<span class="c1">// Works with Promises:</span>
<span class="nx">fn</span><span class="p">(</span><span class="dl">'</span><span class="s1">Hello World!</span><span class="dl">'</span><span class="p">)</span>
<span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">result</span> <span class="o">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">result</span><span class="p">))</span> <span class="c1">// -&gt; Hello World!</span>
<span class="p">.</span><span class="k">catch</span><span class="p">(</span><span class="nx">error</span> <span class="o">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="nx">error</span><span class="p">))</span>

<span class="c1">// Works with Callbacks:</span>
<span class="nx">fn</span><span class="p">(</span><span class="dl">'</span><span class="s1">Hi!</span><span class="dl">'</span><span class="p">,</span> <span class="p">(</span><span class="nx">error</span><span class="p">,</span> <span class="nx">result</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="k">return</span> <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="nx">error</span><span class="p">)</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span>
  <span class="c1">// -&gt; Hi!</span>
<span class="p">})</span>
</code></pre></div></div>

<h2 id="license">License</h2>

<p>MIT</p>

  </body>
</html>
