<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>@nodelib/fs.walk</title>
    <link rel="stylesheet" media="all" href="/assets/css/main.css"/>
  </head>
  <body class="bg-blue-900 p-8">
    <h1 id="nodelibfswalk">@nodelib/fs.walk</h1>

<blockquote>
  <p>A library for efficiently walking a directory recursively.</p>
</blockquote>

<h2 id="bulb-highlights">:bulb: Highlights</h2>

<ul>
  <li>:moneybag: Returns useful information: <code class="language-plaintext highlighter-rouge">name</code>, <code class="language-plaintext highlighter-rouge">path</code>, <code class="language-plaintext highlighter-rouge">dirent</code> and <code class="language-plaintext highlighter-rouge">stats</code> (optional).</li>
  <li>:rocket: On Node.js 10.10+ uses the mechanism without additional calls to determine the entry type for performance reasons. See <a href="https://github.com/nodelib/nodelib/blob/master/packages/fs/fs.scandir/README.md#old-and-modern-mode"><code class="language-plaintext highlighter-rouge">old</code> and <code class="language-plaintext highlighter-rouge">modern</code> mode</a>.</li>
  <li>:gear: Built-in directories/files and error filtering system.</li>
  <li>:link: Can safely work with broken symbolic links.</li>
</ul>

<h2 id="install">Install</h2>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="go">npm install @nodelib/fs.walk
</span></code></pre></div></div>

<h2 id="usage">Usage</h2>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="o">*</span> <span class="k">as</span> <span class="nx">fsWalk</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">@nodelib/fs.walk</span><span class="dl">'</span><span class="p">;</span>

<span class="nx">fsWalk</span><span class="p">.</span><span class="nx">walk</span><span class="p">(</span><span class="dl">'</span><span class="s1">path</span><span class="dl">'</span><span class="p">,</span> <span class="p">(</span><span class="nx">error</span><span class="p">,</span> <span class="nx">entries</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="cm">/* … */</span> <span class="p">});</span>
</code></pre></div></div>

<h2 id="api">API</h2>

<h3 id="walkpath-optionsorsettings-callback">.walk(path, [optionsOrSettings], callback)</h3>

<p>Reads the directory recursively and asynchronously. Requires a callback function.</p>

<blockquote>
  <p>:book: If you want to use the Promise API, use <code class="language-plaintext highlighter-rouge">util.promisify</code>.</p>
</blockquote>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">fsWalk</span><span class="p">.</span><span class="nx">walk</span><span class="p">(</span><span class="dl">'</span><span class="s1">path</span><span class="dl">'</span><span class="p">,</span> <span class="p">(</span><span class="nx">error</span><span class="p">,</span> <span class="nx">entries</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="cm">/* … */</span> <span class="p">});</span>
<span class="nx">fsWalk</span><span class="p">.</span><span class="nx">walk</span><span class="p">(</span><span class="dl">'</span><span class="s1">path</span><span class="dl">'</span><span class="p">,</span> <span class="p">{},</span> <span class="p">(</span><span class="nx">error</span><span class="p">,</span> <span class="nx">entries</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="cm">/* … */</span> <span class="p">});</span>
<span class="nx">fsWalk</span><span class="p">.</span><span class="nx">walk</span><span class="p">(</span><span class="dl">'</span><span class="s1">path</span><span class="dl">'</span><span class="p">,</span> <span class="k">new</span> <span class="nx">fsWalk</span><span class="p">.</span><span class="nx">Settings</span><span class="p">(),</span> <span class="p">(</span><span class="nx">error</span><span class="p">,</span> <span class="nx">entries</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="cm">/* … */</span> <span class="p">});</span>
</code></pre></div></div>

<h3 id="walkstreampath-optionsorsettings">.walkStream(path, [optionsOrSettings])</h3>

<p>Reads the directory recursively and asynchronously. <a href="https://nodejs.org/dist/latest-v12.x/docs/api/stream.html#stream_readable_streams">Readable Stream</a> is used as a provider.</p>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">stream</span> <span class="o">=</span> <span class="nx">fsWalk</span><span class="p">.</span><span class="nx">walkStream</span><span class="p">(</span><span class="dl">'</span><span class="s1">path</span><span class="dl">'</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">stream</span> <span class="o">=</span> <span class="nx">fsWalk</span><span class="p">.</span><span class="nx">walkStream</span><span class="p">(</span><span class="dl">'</span><span class="s1">path</span><span class="dl">'</span><span class="p">,</span> <span class="p">{});</span>
<span class="kd">const</span> <span class="nx">stream</span> <span class="o">=</span> <span class="nx">fsWalk</span><span class="p">.</span><span class="nx">walkStream</span><span class="p">(</span><span class="dl">'</span><span class="s1">path</span><span class="dl">'</span><span class="p">,</span> <span class="k">new</span> <span class="nx">fsWalk</span><span class="p">.</span><span class="nx">Settings</span><span class="p">());</span>
</code></pre></div></div>

<h3 id="walksyncpath-optionsorsettings">.walkSync(path, [optionsOrSettings])</h3>

<p>Reads the directory recursively and synchronously. Returns an array of entries.</p>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">entries</span> <span class="o">=</span> <span class="nx">fsWalk</span><span class="p">.</span><span class="nx">walkSync</span><span class="p">(</span><span class="dl">'</span><span class="s1">path</span><span class="dl">'</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">entries</span> <span class="o">=</span> <span class="nx">fsWalk</span><span class="p">.</span><span class="nx">walkSync</span><span class="p">(</span><span class="dl">'</span><span class="s1">path</span><span class="dl">'</span><span class="p">,</span> <span class="p">{});</span>
<span class="kd">const</span> <span class="nx">entries</span> <span class="o">=</span> <span class="nx">fsWalk</span><span class="p">.</span><span class="nx">walkSync</span><span class="p">(</span><span class="dl">'</span><span class="s1">path</span><span class="dl">'</span><span class="p">,</span> <span class="k">new</span> <span class="nx">fsWalk</span><span class="p">.</span><span class="nx">Settings</span><span class="p">());</span>
</code></pre></div></div>

<h4 id="path">path</h4>

<ul>
  <li>Required: <code class="language-plaintext highlighter-rouge">true</code></li>
  <li>Type: <code class="language-plaintext highlighter-rouge">string | Buffer | URL</code></li>
</ul>

<p>A path to a file. If a URL is provided, it must use the <code class="language-plaintext highlighter-rouge">file:</code> protocol.</p>

<h4 id="optionsorsettings">optionsOrSettings</h4>

<ul>
  <li>Required: <code class="language-plaintext highlighter-rouge">false</code></li>
  <li>Type: <code class="language-plaintext highlighter-rouge">Options | Settings</code></li>
  <li>Default: An instance of <code class="language-plaintext highlighter-rouge">Settings</code> class</li>
</ul>

<p>An <a href="#options"><code class="language-plaintext highlighter-rouge">Options</code></a> object or an instance of <a href="#settings"><code class="language-plaintext highlighter-rouge">Settings</code></a> class.</p>

<blockquote>
  <p>:book: When you pass a plain object, an instance of the <code class="language-plaintext highlighter-rouge">Settings</code> class will be created automatically. If you plan to call the method frequently, use a pre-created instance of the <code class="language-plaintext highlighter-rouge">Settings</code> class.</p>
</blockquote>

<h3 id="settingsoptions">Settings([options])</h3>

<p>A class of full settings of the package.</p>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">settings</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">fsWalk</span><span class="p">.</span><span class="nx">Settings</span><span class="p">({</span> <span class="na">followSymbolicLinks</span><span class="p">:</span> <span class="kc">true</span> <span class="p">});</span>

<span class="kd">const</span> <span class="nx">entries</span> <span class="o">=</span> <span class="nx">fsWalk</span><span class="p">.</span><span class="nx">walkSync</span><span class="p">(</span><span class="dl">'</span><span class="s1">path</span><span class="dl">'</span><span class="p">,</span> <span class="nx">settings</span><span class="p">);</span>
</code></pre></div></div>

<h2 id="entry">Entry</h2>

<ul>
  <li><code class="language-plaintext highlighter-rouge">name</code> — The name of the entry (<code class="language-plaintext highlighter-rouge">unknown.txt</code>).</li>
  <li><code class="language-plaintext highlighter-rouge">path</code> — The path of the entry relative to call directory (<code class="language-plaintext highlighter-rouge">root/unknown.txt</code>).</li>
  <li><code class="language-plaintext highlighter-rouge">dirent</code> — An instance of <a href="./src/types/index.ts"><code class="language-plaintext highlighter-rouge">fs.Dirent</code></a> class.</li>
  <li>[<code class="language-plaintext highlighter-rouge">stats</code>] — An instance of <code class="language-plaintext highlighter-rouge">fs.Stats</code> class.</li>
</ul>

<h2 id="options">Options</h2>

<h3 id="basepath">basePath</h3>

<ul>
  <li>Type: <code class="language-plaintext highlighter-rouge">string</code></li>
  <li>Default: <code class="language-plaintext highlighter-rouge">undefined</code></li>
</ul>

<p>By default, all paths are built relative to the root path. You can use this option to set custom root path.</p>

<p>In the example below we read the files from the <code class="language-plaintext highlighter-rouge">root</code> directory, but in the results the root path will be <code class="language-plaintext highlighter-rouge">custom</code>.</p>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">fsWalk</span><span class="p">.</span><span class="nx">walkSync</span><span class="p">(</span><span class="dl">'</span><span class="s1">root</span><span class="dl">'</span><span class="p">);</span> <span class="c1">// → ['root/file.txt']</span>
<span class="nx">fsWalk</span><span class="p">.</span><span class="nx">walkSync</span><span class="p">(</span><span class="dl">'</span><span class="s1">root</span><span class="dl">'</span><span class="p">,</span> <span class="p">{</span> <span class="na">basePath</span><span class="p">:</span> <span class="dl">'</span><span class="s1">custom</span><span class="dl">'</span> <span class="p">});</span> <span class="c1">// → ['custom/file.txt']</span>
</code></pre></div></div>

<h3 id="concurrency">concurrency</h3>

<ul>
  <li>Type: <code class="language-plaintext highlighter-rouge">number</code></li>
  <li>Default: <code class="language-plaintext highlighter-rouge">Infinity</code></li>
</ul>

<p>The maximum number of concurrent calls to <code class="language-plaintext highlighter-rouge">fs.readdir</code>.</p>

<blockquote>
  <p>:book: The higher the number, the higher performance and the load on the File System. If you want to read in quiet mode, set the value to <code class="language-plaintext highlighter-rouge">4 * os.cpus().length</code> (4 is default size of <a href="http://docs.libuv.org/en/v1.x/threadpool.html#thread-pool-work-scheduling">thread pool work scheduling</a>).</p>
</blockquote>

<h3 id="deepfilter">deepFilter</h3>

<ul>
  <li>Type: <a href="./src/settings.ts"><code class="language-plaintext highlighter-rouge">DeepFilterFunction</code></a></li>
  <li>Default: <code class="language-plaintext highlighter-rouge">undefined</code></li>
</ul>

<p>A function that indicates whether the directory will be read deep or not.</p>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Skip all directories that starts with `node_modules`</span>
<span class="kd">const</span> <span class="nx">filter</span><span class="p">:</span> <span class="nx">DeepFilterFunction</span> <span class="o">=</span> <span class="p">(</span><span class="nx">entry</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="o">!</span><span class="nx">entry</span><span class="p">.</span><span class="nx">path</span><span class="p">.</span><span class="nx">startsWith</span><span class="p">(</span><span class="dl">'</span><span class="s1">node_modules</span><span class="dl">'</span><span class="p">);</span>
</code></pre></div></div>

<h3 id="entryfilter">entryFilter</h3>

<ul>
  <li>Type: <a href="./src/settings.ts"><code class="language-plaintext highlighter-rouge">EntryFilterFunction</code></a></li>
  <li>Default: <code class="language-plaintext highlighter-rouge">undefined</code></li>
</ul>

<p>A function that indicates whether the entry will be included to results or not.</p>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Exclude all `.js` files from results</span>
<span class="kd">const</span> <span class="nx">filter</span><span class="p">:</span> <span class="nx">EntryFilterFunction</span> <span class="o">=</span> <span class="p">(</span><span class="nx">entry</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="o">!</span><span class="nx">entry</span><span class="p">.</span><span class="nx">name</span><span class="p">.</span><span class="nx">endsWith</span><span class="p">(</span><span class="dl">'</span><span class="s1">.js</span><span class="dl">'</span><span class="p">);</span>
</code></pre></div></div>

<h3 id="errorfilter">errorFilter</h3>

<ul>
  <li>Type: <a href="./src/settings.ts"><code class="language-plaintext highlighter-rouge">ErrorFilterFunction</code></a></li>
  <li>Default: <code class="language-plaintext highlighter-rouge">undefined</code></li>
</ul>

<p>A function that allows you to skip errors that occur when reading directories.</p>

<p>For example, you can skip <code class="language-plaintext highlighter-rouge">ENOENT</code> errors if required:</p>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Skip all ENOENT errors</span>
<span class="kd">const</span> <span class="nx">filter</span><span class="p">:</span> <span class="nx">ErrorFilterFunction</span> <span class="o">=</span> <span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">error</span><span class="p">.</span><span class="nx">code</span> <span class="o">==</span> <span class="dl">'</span><span class="s1">ENOENT</span><span class="dl">'</span><span class="p">;</span>
</code></pre></div></div>

<h3 id="stats">stats</h3>

<ul>
  <li>Type: <code class="language-plaintext highlighter-rouge">boolean</code></li>
  <li>Default: <code class="language-plaintext highlighter-rouge">false</code></li>
</ul>

<p>Adds an instance of <code class="language-plaintext highlighter-rouge">fs.Stats</code> class to the <a href="#entry"><code class="language-plaintext highlighter-rouge">Entry</code></a>.</p>

<blockquote>
  <p>:book: Always use <code class="language-plaintext highlighter-rouge">fs.readdir</code> with additional <code class="language-plaintext highlighter-rouge">fs.lstat/fs.stat</code> calls to determine the entry type.</p>
</blockquote>

<h3 id="followsymboliclinks">followSymbolicLinks</h3>

<ul>
  <li>Type: <code class="language-plaintext highlighter-rouge">boolean</code></li>
  <li>Default: <code class="language-plaintext highlighter-rouge">false</code></li>
</ul>

<p>Follow symbolic links or not. Call <code class="language-plaintext highlighter-rouge">fs.stat</code> on symbolic link if <code class="language-plaintext highlighter-rouge">true</code>.</p>

<h3 id="throwerroronbrokensymboliclink"><code class="language-plaintext highlighter-rouge">throwErrorOnBrokenSymbolicLink</code></h3>

<ul>
  <li>Type: <code class="language-plaintext highlighter-rouge">boolean</code></li>
  <li>Default: <code class="language-plaintext highlighter-rouge">true</code></li>
</ul>

<p>Throw an error when symbolic link is broken if <code class="language-plaintext highlighter-rouge">true</code> or safely return <code class="language-plaintext highlighter-rouge">lstat</code> call if <code class="language-plaintext highlighter-rouge">false</code>.</p>

<h3 id="pathsegmentseparator"><code class="language-plaintext highlighter-rouge">pathSegmentSeparator</code></h3>

<ul>
  <li>Type: <code class="language-plaintext highlighter-rouge">string</code></li>
  <li>Default: <code class="language-plaintext highlighter-rouge">path.sep</code></li>
</ul>

<p>By default, this package uses the correct path separator for your OS (<code class="language-plaintext highlighter-rouge">\</code> on Windows, <code class="language-plaintext highlighter-rouge">/</code> on Unix-like systems). But you can set this option to any separator character(s) that you want to use instead.</p>

<h3 id="fs"><code class="language-plaintext highlighter-rouge">fs</code></h3>

<ul>
  <li>Type: <code class="language-plaintext highlighter-rouge">FileSystemAdapter</code></li>
  <li>Default: A default FS methods</li>
</ul>

<p>By default, the built-in Node.js module (<code class="language-plaintext highlighter-rouge">fs</code>) is used to work with the file system. You can replace any method with your own.</p>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kr">interface</span> <span class="nx">FileSystemAdapter</span> <span class="p">{</span>
	<span class="nl">lstat</span><span class="p">:</span> <span class="k">typeof</span> <span class="nx">fs</span><span class="p">.</span><span class="nx">lstat</span><span class="p">;</span>
	<span class="nl">stat</span><span class="p">:</span> <span class="k">typeof</span> <span class="nx">fs</span><span class="p">.</span><span class="nx">stat</span><span class="p">;</span>
	<span class="nl">lstatSync</span><span class="p">:</span> <span class="k">typeof</span> <span class="nx">fs</span><span class="p">.</span><span class="nx">lstatSync</span><span class="p">;</span>
	<span class="nl">statSync</span><span class="p">:</span> <span class="k">typeof</span> <span class="nx">fs</span><span class="p">.</span><span class="nx">statSync</span><span class="p">;</span>
	<span class="nl">readdir</span><span class="p">:</span> <span class="k">typeof</span> <span class="nx">fs</span><span class="p">.</span><span class="nx">readdir</span><span class="p">;</span>
	<span class="nl">readdirSync</span><span class="p">:</span> <span class="k">typeof</span> <span class="nx">fs</span><span class="p">.</span><span class="nx">readdirSync</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">const</span> <span class="nx">settings</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">fsWalk</span><span class="p">.</span><span class="nx">Settings</span><span class="p">({</span>
	<span class="na">fs</span><span class="p">:</span> <span class="p">{</span> <span class="na">lstat</span><span class="p">:</span> <span class="nx">fakeLstat</span> <span class="p">}</span>
<span class="p">});</span>
</code></pre></div></div>

<h2 id="changelog">Changelog</h2>

<p>See the <a href="https://github.com/nodelib/nodelib/releases">Releases section of our GitHub project</a> for changelog for each release version.</p>

<h2 id="license">License</h2>

<p>This software is released under the terms of the MIT license.</p>

  </body>
</html>
